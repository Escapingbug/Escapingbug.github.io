


<html>
    <head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="keywords" content="CTF hacker binary-exploit">
<meta property="og:type" content="website">
<meta property="og:title" content="AncyBlog">
<meta property="og:url" content="https://anciety/me/index.html">
<meta property="og:site_name" content="AncyBlog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AncyBlog">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>AncyBlog</title>
    <!-- styles -->
    <link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
    <!-- rss -->
    
    


    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="/js/jquery.terminal.min.js"></script>
        <script>
// terminal utils
// Some util functions which needs to be configured

function util_navigate_archive() {
    window.location = "/archives";
}

function util_print_post(content, term) {
    //var content = '<div class="content">' + content + '</div>\n';
    term.echo(content, {raw: true});
}

function util_print_post_error(term) {
    term.echo('No such post\n');
}

var json_api = {
    about: get_about_page,
    posts: get_posts,
    page: get_post_by_page,
    post: get_post,
};

function get_about_page() {
    return axios.get('api/pages/about.json');
}

function get_posts() {
    return axios.get('api/posts.json');
}

function get_post_by_page(page) {
    return axios.get('api/posts/' + page + '.json');
}

function get_post(num, posts) {
    console.log('getting post now ' + JSON.stringify(posts));
    var post_path = posts.data.data[num].path;
    console.log('getting post: ' + post_path);
    return axios.get(post_path);
}

</script>

        <script>

var prompt = 'AncyBlog $&gt; '
var greetings = "Welcome to Anciety&#39;s Blog! Type &#34;help&#34; or &#34;h&#34; for help message"

var terminal_settings = {
    prompt: prompt,
    greetings: function() {
        this.echo(greetings);
    }
};

var commands = {
    'help': [help_cmd, "help message"],
    'h': [help_cmd, "help message"],
    'normal': [normal_cmd, 'Mayday! Mayday! I am no geek, get me out! I want normal blog entrence!'],
    'n': [normal_cmd, 'alias to normal'],
    'posts': [posts_cmd, 'read posts'],
    'p': [posts_cmd, 'alias to posts'],
};


    // add about command
    commands["anciety"] = [about_cmd, "who is this Anciety anyway?"];


class Posts {
    constructor() {
        this.posts = null;
        this.post_list = '';
    }
    
    setup_post() {
        return json_api
            .posts()
            .then((response) => {
                this.posts = response;
                this.post_list = '';
                var data = response.data.data;

                for (var each in data) {
                    this.post_list += each + '|\t' + data[each].title + '\n';
                }
            });
    }

    get_post() {
        if (this.posts !== null) {
            return new Promise((resolve, reject) => {
                resolve(this.posts);
            });
        }
        return this.setup_post().then(() => this.posts);
    }

    get_post_list() {
        if (this.posts !== null) {
            return new Promise((resolve, reject) => {
                resolve(this.post_list);
            });
        }

        return this.setup_post().then(() => this.post_list);
    }

    get_post(arg) {
        var prom = null;
        if (this.posts !== null) {
            prom = new Promise((resolve, reject) => resolve(this.posts));
        } else {
            prom = this.setup_post().then(() => this.posts);
        }

        return prom.then((posts) => {

            if (!/\D/.test(arg)) {
                // number
                return json_api
                    .post(arg, posts);
            } else {
                // title
                var num = -1;
                var data = posts.data.data;
                for (var each in data) {
                    if (data[each].title === arg) {
                        num = each;
                    }
                }
    
                if (num === -1) {
                    this.echo('Sorry, post not found\n');
                } else {
                    return json_api
                        .post(num, posts);
                }
            }
        });
    }
}

var posts = new Posts();

function help_message() {
    var msg = 'Available commands:\n';
    for (var cmd in commands) {
        var cmd_help = commands[cmd][1];
        msg += '\t' + cmd + '\t-\t' + cmd_help + '\n';
    }
    msg += '\nEnjoy!\n';
    return msg;
}

/* commands */

function help_cmd() {
    this.echo(help_message());
}

function command_not_found() {
    this.echo("no such command, type \"help\" or \"h\" for help");
}

function about_cmd() {
    json_api.about()
        .then((response) => {
            var content = '<div class="content">' + response.data.content + '</div>';
            this.echo(content, {raw: true});
        });
}

function normal_cmd() {
    util_navigate_archive();
}

function posts_cmd(subcommand, arg) {


    var subcommand_help = () => {
        var help_msg = 'Posts related commands, available subcommands:\n';
        for (var cmd in subcommands) {
            help_msg += '\t' + cmd + '\t-\t' + subcommands[cmd][1] + '\n';
        }
        help_msg += '\n';
        this.echo(help_msg);
    }

    var subcommand_list = () => {
        posts.get_post_list()
            .then((list) => {
                this.echo(list);
            });
    }

    var subcommand_read = (arg) => {
        if (typeof arg === 'undefined') {
            this.echo('read needs an argument\n');
            return;
        }

        posts.get_post(arg)
            .then((content) => util_print_post(content.data.content, this))
            .catch(() => util_print_post_error(this));
    }

    var subcommands = {
        'help': [subcommand_help, 'print help message'],
        'list': [subcommand_list, 'list post titles'],
        'read': [subcommand_read, 'read [title | post_num]'],
    }

    if (!subcommand || !subcommands[subcommand]) {
        subcommand_help();
        return;
    }

    subcommands[subcommand][0](arg);
}

function terminal_commands() {
    var terminal_cmds = [];

    for (var cmd in commands) {
        terminal_cmds.push({
            [cmd]: commands[cmd][0]
        });
    }
    terminal_cmds.push(command_not_found);

    console.log(terminal_cmds);

    return terminal_cmds;
}

$(document).ready(
    function() {
        $('body').terminal(terminal_commands(), terminal_settings)
    }
);

</script>


        <link rel="stylesheet" href="/css/jquery.terminal.min.css">
        <link rel="stylesheet" href="/css/terminal.css">
</head>

   <body>
    </body>
</html>


